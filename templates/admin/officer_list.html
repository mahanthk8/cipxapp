{% extends "base.html" %}
{% block title %}Officer Management{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- Header Section -->
    <div class="row align-items-center mb-4">
        <div class="col">
            <h2 class="display-6 fw-bold text-primary mb-1">
                <i class="fas fa-user-shield me-2"></i>Officer Directory
            </h2>
            <p class="text-muted">Manage field officers, workloads, and regional assignments.</p>
        </div>
        <div class="col-auto">
            <a href="{% url 'officer_create' %}" class="btn btn-primary btn-lg rounded-pill shadow-sm hover-lift">
                <i class="fas fa-plus-circle me-2"></i>Create Officer
            </a>
        </div>
    </div>

    <!-- Officers Table Card -->
    <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="bg-light">
                    <tr>
                        <th class="ps-4 border-0 text-uppercase small fw-bold text-secondary">Officer Name</th>
                        <th class="border-0 text-uppercase small fw-bold text-secondary">Region</th>
                        <th class="border-0 text-uppercase small fw-bold text-secondary text-center">Rating</th>
                        <th class="border-0 text-uppercase small fw-bold text-secondary" style="width: 200px;">Workload</th>
                        <th class="border-0 text-uppercase small fw-bold text-secondary text-center">Status</th>
                        <th class="pe-4 border-0 text-uppercase small fw-bold text-secondary text-end">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for o in officers %}
                    <tr>
                        <td class="ps-4">
                            <div class="d-flex align-items-center">
                                <div class="avatar-sm bg-primary-soft text-primary rounded-circle me-3 d-flex align-items-center justify-content-center">
                                    <span class="fw-bold">{{ o.username|slice:":1"|upper }}</span>
                                </div>
                                <span class="fw-semibold text-dark">{{ o.username }}</span>
                            </div>
                        </td>
                        <td>
                            <span class="badge bg-light text-dark border fw-normal px-2 py-1">
                                <i class="fas fa-map-marker-alt text-danger me-1"></i> {{ o.region }}
                            </span>
                        </td>
                        <td class="text-center">
                            <span class="text-warning fw-bold">
                                <i class="fas fa-star me-1"></i>{{ o.star }}
                            </span>
                        </td>
                        <td>
                            <div class="d-flex align-items-center">
                                <div class="progress flex-grow-1 me-2" style="height: 6px;">
                                    <!-- Dynamic color based on workload -->
                                    <div class="progress-bar {% if o.active_cases > 5 %}bg-danger{% elif o.active_cases > 2 %}bg-warning{% else %}bg-success{% endif %}" 
                                         role="progressbar" 
                                         style="width: {{ o.active_cases|add:o.active_cases }}0%"></div>
                                </div>
                                <small class="text-muted fw-bold">{{ o.active_cases }} Cases</small>
                            </div>
                        </td>
                        <td class="text-center">
                            {% if o.is_active %}
                                <span class="badge rounded-pill bg-success-soft text-success px-3">
                                    <i class="fas fa-circle fa-xs me-1"></i> Active
                                </span>
                            {% else %}
                                <span class="badge rounded-pill bg-danger-soft text-danger px-3">
                                    <i class="fas fa-circle fa-xs me-1"></i> Inactive
                                </span>
                            {% endif %}
                        </td>
                        <td class="pe-4 text-end">
                            <a href="{% url 'officer_update' o.pk %}" 
                               class="btn btn-sm btn-outline-warning rounded-pill px-3 me-2">
                                <i class="fas fa-edit me-1"></i>Edit
                            </a> &nbsp;&nbsp;
                            <a href="{% url 'officer_toggle_status' o.pk %}" 
                               class="btn btn-sm {% if o.is_active %}btn-outline-danger{% else %}btn-outline-success{% endif %} rounded-pill px-3">
                                <i class="fas {% if o.is_active %}fa-power-off{% else %}fa-check{% endif %} me-1"></i>
                                {% if o.is_active %}Deactivate{% else %}Activate{% endif %}
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="text-center py-5">
                            <div class="text-muted">
                                <i class="fas fa-users-slash fa-3x mb-3"></i>
                                <p>No officers registered in the system.</p>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<style>
    /* Modern Styling Variable and Classes */
    :root {
        --primary-soft: rgba(13, 110, 253, 0.1);
        --success-soft: rgba(25, 135, 84, 0.1);
        --danger-soft: rgba(220, 53, 69, 0.1);
    }

    body { background-color: #f8fafc; }
    
    /* Table Enhancements */
    .table-hover tbody tr:hover {
        background-color: #fcfcfc;
        transition: background-color 0.2s ease;
    }

    .avatar-sm { width: 36px; height: 36px; }
    
    .bg-primary-soft { background-color: var(--primary-soft); }
    .bg-success-soft { background-color: var(--success-soft); }
    .bg-danger-soft { background-color: var(--danger-soft); }

    .hover-lift {
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .hover-lift:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(13, 110, 253, 0.15) !important;
    }

    .progress { border-radius: 10px; background-color: #e9ecef; }
    
    /* Clean Table Removal */
    .table td, .table th { padding-top: 1rem; padding-bottom: 1rem; }
</style>
{% endblock %}
